
- name: Build APK with Buildozer
  run: |
    # Û±. Ø­Ø°Ù Ù¾ÙˆØ´Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ØªÙ…ÛŒØ²
    rm -rf .buildozer 2>/dev/null || true
    
    # Û². Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…Ø³ØªÙ‚ÛŒÙ… SDK Command Line Tools Ø¬Ø¯ÛŒØ¯ Ùˆ Ù†ØµØ¨ Ø¢Ù†
    # Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡ Ø§Ø² sdkmanager Ù…Ø¯Ø±Ù†â€ŒØªØ± Ø§Ø³Øª Ùˆ Ø§Ø² --licenses Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
    echo "ðŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ SDK Command Line Tools Ø¬Ø¯ÛŒØ¯..."
    cd ~/.buildozer/android/platform
    wget -q https://dl.google.com/android/repository/commandlinetools-linux-9477386_latest.zip
    unzip -q commandlinetools-linux-9477386_latest.zip -d cmdline-tools
    mv cmdline-tools/cmdline-tools cmdline-tools/latest
    rm commandlinetools-linux-9477386_latest.zip
    
    # Û³. ØªÙ†Ø¸ÛŒÙ… Ù…Ø³ÛŒØ± Ùˆ Ù‚Ø¨ÙˆÙ„ ØªÙ…Ø§Ù… Ù„Ø§ÛŒØ³Ù†Ø³â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª ØºÛŒØ±ØªØ¹Ø§Ù…Ù„ÛŒ
    export ANDROID_SDK_ROOT=~/.buildozer/android/platform/android-sdk
    ~/.buildozer/android/platform/cmdline-tools/latest/bin/sdkmanager --sdk_root=$ANDROID_SDK_ROOT --licenses --verbose <<< "y"*10
    
    # Û´. Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ùˆ Ø³Ø§Ø®Øª APK
    cd /home/runner/work/Breathing_app_1/Breathing_app_1
    echo "ðŸš€ Ø´Ø±ÙˆØ¹ Ø³Ø§Ø®Øª APK..."
    buildozer android debug
    
    # Ûµ. Ø§Ú¯Ø± Ø®Ø·Ø§ Ø¯Ø§Ø´ØªØŒ ÛŒÚ© Ø¨Ø§Ø± Ø¯ÛŒÚ¯Ø± ØªÙ„Ø§Ø´ Ú©Ù†
    if [ $? -ne 0 ]; then
      echo "âš ï¸  Ø³Ø§Ø®Øª Ø§ÙˆÙ„ Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯ØŒ ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯..."
      buildozer android debug
    fi
